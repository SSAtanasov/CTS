# Конфигуриране на номерирани стандартни IPv4 ACL (Configure Numbered Standard IPv4 ACLs)

## Таблица с адресиране (Addressing Table)

| Устройство | Интерфейс | IP адрес | Маска на подмрежата | Стандартен шлюз |
|---|---|---|---|---|
| R1 | G0/0 | 192.168.10.1 | 255.255.255.0 | N/A |
| R1 | G0/1 | 192.168.11.1 | 255.255.255.0 | N/A |
| R1 | S0/0/0 | 10.1.1.1 | 255.255.255.252 | N/A |
| R1 | S0/0/1 | 10.3.3.1 | 255.255.255.252 | N/A |
| R2 | G0/0 | 192.168.20.1 | 255.255.255.0 | N/A |
| R2 | S0/0/0 | 10.1.1.2 | 255.255.255.252 | N/A |
| R2 | S0/0/1 | 10.2.2.1 | 255.255.255.252 | N/A |
| R3 | G0/0 | 192.168.30.1 | 255.255.255.0 | N/A |
| R3 | S0/0/0 | 10.3.3.2 | 255.255.255.252 | N/A |
| R3 | S0/0/1 | 10.2.2.2 | 255.255.255.252 | N/A |
| PC1 | NIC | 192.168.10.10 | 255.255.255.0 | 192.168.10.1 |
| PC2 | NIC | 192.168.11.10 | 255.255.255.0 | 192.168.11.1 |
| PC3 | NIC | 192.168.30.10 | 255.255.255.0 | 192.168.30.1 |
| WebServer | NIC | 192.168.20.254 | 255.255.255.0 | 192.168.20.1 |

## Цели

**Част I:** Планиране на внедряване на ACL

**Част II:** Конфигуриране, прилагане и проверка на стандартен ACL

## Контекст / Сценарий

Стандартните списъци за контрол на достъпа (ACL - Access Control Lists) са конфигурационни скриптове на рутера, които контролират дали рутерът разрешава или отказва пакети на базата на адреса на източника. Това упражнение се фокусира върху дефинирането на критерии за филтриране, конфигурирането на стандартни ACL, прилагането на ACL към интерфейси на рутера и проверката и тестването на внедряването на ACL. Рутерите вече са конфигурирани, включително IP адреси и протокол за маршрутизация Enhanced Interior Gateway Routing Protocol (EIGRP).

## Указания

### Част I: Планиране на внедряване на ACL

#### Стъпка 1: Изследване на текущата мрежова конфигурация

Преди да приложите ACL към мрежа, важно е да потвърдите, че имате пълна свързаност. Проверете дали мрежата има пълна свързаност, като изберете компютър и изпратите ping до други устройства в мрежата. Трябва да можете успешно да изпратите ping до всяко устройство.

#### Стъпка 2: Оценка на две мрежови политики и планиране на внедряване на ACL

а. Следните мрежови политики са внедрени на R2:
- Мрежата 192.168.11.0/24 няма разрешен достъп до уеб сървъра в мрежата 192.168.20.0/24
- Всички останали достъпи са разрешени

За да ограничите достъпа от мрежата 192.168.11.0/24 до уеб сървъра на адрес 192.168.20.254 без да пречите на друг трафик, трябва да се създаде ACL на R2. Списъкът за контрол на достъпа трябва да бъде поставен на изходящия интерфейс към уеб сървъра. Трябва да се създаде второ правило на R2, за да разреши целия останал трафик.

б. Следните мрежови политики са внедрени на R3:
- Мрежата 192.168.10.0/24 няма разрешение да комуникира с мрежата 192.168.30.0/24
- Всички останали достъпи са разрешени

За да ограничите достъпа от мрежата 192.168.10.0/24 до мрежата 192.168.30/24 без да пречите на друг трафик, трябва да се създаде списък за контрол на достъпа на R3. ACL трябва да бъде поставен на изходящия интерфейс към PC3. Трябва да се създаде второ правило на R3, за да разреши целия останал трафик.

### Част II: Конфигуриране, прилагане и проверка на стандартен ACL

#### Стъпка 1: Конфигуриране и прилагане на номериран стандартен ACL на R2

а. Създайте ACL с номер 1 на R2 с оператор, който отказва достъп до мрежата 192.168.20.0/24 от мрежата 192.168.11.0/24.

```
R2(config)# access-list 1 deny 192.168.11.0 0.0.0.255
```

б. По подразбиране списък за контрол на достъпа отказва целия трафик, който не съответства на никакви правила. За да разрешите целия останал трафик, конфигурирайте следния оператор:

```
R2(config)# access-list 1 permit any
```

в. Преди да приложите списък за контрол на достъпа към интерфейс за филтриране на трафик, най-добрата практика е да прегледате съдържанието на списъка за контрол на достъпа, за да проверите, че той ще филтрира трафика както се очаква.

```
R2# show access-lists
Standard IP access list 1
10 deny 192.168.11.0 0.0.0.255
20 permit any
```

г. За да филтрира действително трафика ACL, той трябва да бъде приложен към някоя операция на рутера. Приложете ACL, като го поставите за изходящ трафик на интерфейса GigabitEthernet 0/0. 

**Забележка:** В действителна работеща мрежа не е добра практика да се прилага нетестван списък за контрол на достъпа към активен интерфейс.

```
R2(config)# interface GigabitEthernet0/0
R2(config-if)# ip access-group 1 out
```

#### Стъпка 2: Конфигуриране и прилагане на номериран стандартен ACL на R3

а. Създайте ACL с номер 1 на R3 с оператор, който отказва достъп до мрежата 192.168.30.0/24 от мрежата на PC1 (192.168.10.0/24).

```
R3(config)# access-list 1 deny 192.168.10.0 0.0.0.255
```

б. По подразбиране ACL отказва целия трафик, който не съответства на никакви правила. За да разрешите целия останал трафик, създайте второ правило за ACL 1.

```
R3(config)# access-list 1 permit any
```

в. Проверете дали списъкът за контрол на достъпа е конфигуриран правилно.

```
R3# show access-lists
Standard IP access list 1
10 deny 192.168.10.0 0.0.0.255
20 permit any
```

г. Приложете ACL, като го поставите за изходящ трафик на интерфейса GigabitEthernet 0/0.

```
R3(config)# interface GigabitEthernet0/0
R3(config-if)# ip access-group 1 out
```

#### Стъпка 3: Проверка на конфигурацията и функционалността на ACL

а. Въведете командата `show run` или `show ip interface gigabitethernet 0/0`, за да проверите разположенията на ACL.

б. С двата ACL на място мрежовият трафик е ограничен според политиките, подробно описани в Част I. Използвайте следните тестове, за да проверите внедряванията на ACL:
- Ping от 192.168.10.10 до 192.168.11.10 е успешен
- Ping от 192.168.10.10 до 192.168.20.254 е успешен
- Ping от 192.168.11.10 до 192.168.20.254 е неуспешен
- Ping от 192.168.10.10 до 192.168.30.10 е неуспешен
- Ping от 192.168.11.10 до 192.168.30.10 е успешен
- Ping от 192.168.30.10 до 192.168.20.254 е успешен

в. Изпълнете командата `show access-lists` отново на рутерите R2 и R3. Трябва да видите изход, който показва броя на пакетите, които съответстват на всеки ред от списъка за контрол на достъпа. 

**Забележка:** Броят на съвпаденията, показани за вашите рутери, може да бъде различен поради броя на изпратените и получени ping пакети.

```
R2# show access-lists
Standard IP access list 1
10 deny 192.168.11.0 0.0.0.255 (4 match(es))
20 permit any (8 match(es))

R3# show access-lists 
Standard IP access list 1
10 deny 192.168.10.0 0.0.0.255 (4 match(es))
20 permit any (8 match(es))
```

---

## Речник на термините

**ACL** - Access Control List (Списък за контрол на достъпа)

**Numbered ACL** - Номериран списък за контрол на достъпа (идентифициран с номер)

**Standard ACL** - Стандартен списък за контрол на достъпа (филтрира само по IP адрес на източника)

**Extended ACL** - Разширен списък за контрол на достъпа (филтрира по източник, местоназначение, порт и протокол)

**Wildcard mask** - Маска с заместващи знаци (обратна на маската на подмрежата, използва се в ACL)

**permit** - Разрешаване на трафик

**deny** - Отказване / Забраняване на трафик

**any** - Всеки / Всички адреси (еквивалент на 0.0.0.0 255.255.255.255)

**match** - Съвпадение (когато пакет отговаря на критериите на правило в ACL)

**outbound** - Изходящ (трафик, който напуска интерфейса)

**inbound** - Входящ (трафик, който влиза в интерфейса)

**EIGRP** - Enhanced Interior Gateway Routing Protocol (подобрен протокол за вътрешна маршрутизация)

**implicit deny** - Неявен отказ (скрито правило в края на всеки ACL, което отказва всичко, което не е изрично разрешено)
